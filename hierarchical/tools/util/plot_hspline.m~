function plot_hspline(u, hmsh, hspace) 

% u degrees of freedom

[Z, pts] = hspline_eval(u, hmsh, hspace, 3);

nptos = size(ptos,2);
nptos_idir = round(nthroot(nptos,hmsh.ndim));
figure
hold
for el = 1:hmsh.nel
    x = reshape(pts(1,:,el), nptos_idir*ones(1,hmsh.ndim;
    y = pts(2,:,el);
    (x,y,Z(:,el));
end
axis tight
xlabel('x')
ylabel('y')
hold off

% x = hmsh.geo_map(1,:,:);
% y = hmsh.geo_map(2,:,:);
% x = x(:); y = y(:);
% xxx = linspace(.01,.99,20);
% [X,Y] = meshgrid(xxx,xxx);
% ZZ = griddata(x,y,Z(:),X,Y);
% 
% surf(X,Y, ZZ);
% axis tight
% xlabel('x')
% ylabel('y')
